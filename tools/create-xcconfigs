#!/usr/bin/env node

const { program } = require('commander')
const { buildConfigs } = require('../build-configs')
const fs = require('fs')

program
  .option('-d, --debug', 'enable extreme logging')

const createXcconfigs = async () => {
  Object.keys(buildConfigs).forEach(key => {
    const { iosBuildOptions } = buildConfigs[key]
    const content = Object.keys(iosBuildOptions).map(key => `${key} = ${iosBuildOptions[key]}`).join('\n')
    fs.writeFileSync(`ios/${key}.tmp.xcconfig`, content)
  })
}

program
  .description('commits the supplied version name and code to github and tags the commit')
  .action(async () => {
    try {
      await createXcconfigs()
    } catch (e) {
      console.error(e)
      process.exit(1)
    }
  })

program.parse(process.argv)
